@api = http://localhost:5000/api
@token = 

###
# Owner User Tests
# This file tests all actions for a user with the 'Owner' role.
# An Owner should be able to perform all actions on all users and businesses.
###

# Login as Owner
# dni: 28470359 password: Password1234
# @name login_owner
POST {{api}}/auth/login
Content-Type: application/json

{
  "dni": "28470359",
  "password": "Password1234"
}

###
@token = {{login_owner.response.body.token}}
@own_business_uuid = {{login_owner.response.body.user.businesses_roles[0].uuid}}

###
# User endpoints (Owner)
###

# Create a new user (Owner)
POST {{api}}/users
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "firstName": "Technician",
  "lastName": "User",
  "email": "technician.user.unique@example.com",
  "password": "Password1234",
  "phone": "2222222",
  "dni": "2222222",
  "street": "Technician St",
  "city": "Technician City",
  "state": "Technician State",
  "country": "Technician Country",
  "zipCode": "11111",
  "business_uuid": "1a2b3c4d-5e6f-4a7b-8c9d-0e1f2a3b4c5d",
  "role": "Technician"
}

###

# Get all users (Owner)
GET {{api}}/users
Authorization: Bearer {{token}}

###

# Get user by ID (Owner) - Use a placeholder UUID, replace with an actual user ID
GET {{api}}/users/31cc4ae3-5689-4c90-a21e-909722a73cc2
Authorization: Bearer {{token}}

###

# Update user (Owner) - Use a placeholder UUID, replace with an actual user ID
PUT {{api}}/users/31cc4ae3-5689-4c90-a21e-909722a73cc2
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "phone": "0987654321",
  "street": "456 Tech Ave",
  "city": "Tech city Updated",
  "is_active": true
}

###

# Update user image (Owner) - Use a placeholder UUID, replace with an actual user ID
# Note: Create a test.jpg file in the root directory for this to work.
PUT {{api}}/users/31cc4ae3-5689-4c90-a21e-909722a73cc2/image
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW
Authorization: Bearer {{token}}

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="image"; filename="test.jpg"
Content-Type: image/jpeg

< ./test.jpg
------WebKitFormBoundary7MA4YWxkTrZu0gW--

###

# Delete user (Owner) - Use a placeholder UUID, replace with an actual user ID
DELETE {{api}}/users/31cc4ae3-5689-4c90-a21e-909722a73cc2
Authorization: Bearer {{token}}


### Delete user Hard (Owner) -  Use a placeholder UUID, replace with an actual user ID

DELETE {{api}}/users/31cc4ae3-5689-4c90-a21e-909722a73cc2/hard
Authorization: Bearer {{token}}

###
# Business endpoints (Owner)
###

# Create a new business (Owner)
POST {{api}}/businesses
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "name": "Owner Test Business Inc.",
  "description": "A test business created by Owner.",
  "email": "owner.business.unique@example.com",
  "phone": "222222222",
  "street": "789 Owner Business Rd",
  "city": "Owner Businesstown",
  "state": "Owner Businessland",
  "country": "Owner BUSA",
  "zip_code": "22222"
}

###

# Get all businesses (Owner)
GET {{api}}/businesses
Authorization: Bearer {{token}}

###

# Get business by ID (Owner) - Use a placeholder UUID, replace with an actual business ID
GET {{api}}/businesses/{{own_business_uuid}}
Authorization: Bearer {{token}}

###

# Update business (Owner) - Use a placeholder UUID, replace with an actual business ID
PUT {{api}}/businesses/{{own_business_uuid}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "phone": "1212121212",
  "description": "An updated test business description by Owner.",
  "is_active": true
}

###

# Update business image (Owner) - Use a placeholder UUID, replace with an actual business ID
# Note: Create a test.jpg file in the root directory for this to work.
PUT {{api}}/businesses/{{own_business_uuid}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW
Authorization: Bearer {{token}}

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="image"; filename="test.jpg"
Content-Type: image/jpeg

< ./test.jpg
------WebKitFormBoundary7MA4YWxkTrZu0gW--

###

# Delete business (Owner) - Use a placeholder UUID, replace with an actual business ID
DELETE {{api}}/businesses/dac04fec-f188-4862-ad9a-d7faf0076695
Authorization: Bearer {{token}}

###

# HARD Delete business (Owner) - Use a placeholder UUID, replace with an actual business ID
DELETE {{api}}/businesses/dac04fec-f188-4862-ad9a-d7faf0076695/hard
Authorization: Bearer {{token}}
